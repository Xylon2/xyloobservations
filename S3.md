# Creating an S3 bucket

This is some notes on how to setup an S3 bucket with the appropriate policies
to use with xyloobservations.

It needs to be publicly readable, and writable just by an IAM user.

Create an AWS account.

Create a bucket. You may leave most of the settings default, just edit 
"Block Public Access settings":
- un-check "Block all public access"
- check "I acknowledge that..."

Now click on your bucket, go to the "Permissions" tab, and paste this into the
"Bucket policy", replacing where it sais "BUCKETNAME" with this bucket's name:
```
{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Effect": "Allow",
            "Principal": "*",
            "Action": [
                "s3:GetObject"
            ],
            "Resource": [
                "arn:aws:s3:::BUCKETNAME/*"
            ]
        }
    ]
}
```

Your bucket is now publicly accessible for Read operations.

Now, create a policy. Call it "imageupload_BUCKETNAME". And replace where it
sais "BUCKETNAME" with this bucket's name:

```
{
 "Version":"2012-10-17",
 "Statement": [
   {
     "Action": ["s3:ListAllMyBuckets", "s3:GetBucketLocation"],
     "Effect": "Allow",
     "Resource": ["arn:aws:s3:::*"]
   },
   {
     "Action": ["s3:ListBucket", "s3:GetObject", "s3:PutObject"],
     "Effect": "Allow",
     "Resource": ["arn:aws:s3:::BUCKETNAME/*"]
   }
 ]
}
```

Create an IAM user with the same name, and an access key. When you set permissions do "Attach existing policies directly" and attach your policy.

Now take the access key and secret key and add them to your config.
